<!DOCTYPE html>
<html>
<head>
	<title>Consize as Web App</title>

	<script src="js/codemirror.js"></script>
	<script src="js/codemirror/mode/clojure.js"></script>
	<script src="js/codemirror/matchbrackets.js"></script>

	<link href="css/screen.css" rel="stylesheet"/>
	<link href="css/codemirror.css" rel="stylesheet"/>
	<link href="css/codemirror/solarized.css" rel="stylesheet"/>

	<script src="js/jquery-2.0.3.min.js"></script>
	<script src="js/jquery.console.js"></script>
	<script src="js/out/goog/base.js"></script>
	<script src="js/consize.js"></script>
	<script>goog.require('consize.web.core');</script>
<!--
	<script>
		window.requestFileSystem = window.requestFileSystem || window.webkitRequestFileSystem;
		var fs = null;

		function errorHandler(e) {
			var msg = '';
			switch (e.code) {
				case FileError.QUOTA_EXCEEDED_ERR:
					msg = 'QUOTA_EXCEEDED_ERR';
					break;
				case FileError.NOT_FOUND_ERR:
					msg = 'NOT_FOUND_ERR';
					break;
				case FileError.SECURITY_ERR:
					msg = 'SECURITY_ERR';
					break;
				case FileError.INVALID_MODIFICATION_ERR:
					msg = 'INVALID_MODIFICATION_ERR';
					break;
				case FileError.INVALID_STATE_ERR:
					msg = 'INVALID_STATE_ERR';
					break;
				default:
					msg = 'Unknown Error';
					break;
			};
			document.querySelector('#example-list-fs-ul').innerHTML = 'Error: ' + msg;
		}

		function initFS() {
			window.requestFileSystem(window.TEMPORARY, 1024*1024, function(filesystem) {
				fs = filesystem;
			}, errorHandler);
		}

		var buttons = document.querySelectorAll('#example-list-fs button');
		var filelist = document.querySelector('#example-list-fs-ul');

		if (buttons.length >= 3) {
			buttons[0].addEventListener('click', function(e) {
				if (!fs) {
					return;
				}
				fs.root.getFile('log.txt', {create: true}, null, errorHandler);
				fs.root.getFile('song.mp3', {create: true}, null, errorHandler);
				fs.root.getDirectory('mypictures', {create: true}, null, errorHandler);
				filelist.innerHTML = 'Files created.';
			}, false);

			buttons[1].addEventListener('click', function(e) {
				if (!fs) {
					return;
				}

				var dirReader = fs.root.createReader();
				dirReader.readEntries(function(entries) {
					if (!entries.length) {
						filelist.innerHTML = 'Filesystem is empty.';
					} else {
						filelist.innerHTML = '';
					}

					var fragment = document.createDocumentFragment();
					for (var i = 0, entry; entry = entries[i]; ++i) {
						var img = entry.isDirectory ? '<img src="http://www.html5rocks.com/static/images/tutorials/icon-folder.gif">' :
								'<img src="http://www.html5rocks.com/static/images/tutorials/icon-file.gif">';
						var li = document.createElement('li');
						li.innerHTML = [img, '<span>', entry.name, '</span>'].join('');
						fragment.appendChild(li);
					}
					filelist.appendChild(fragment);
				}, errorHandler);
			}, false);

			buttons[2].addEventListener('click', function(e) {
				if (!fs) {
					return;
				}

				var dirReader = fs.root.createReader();
				dirReader.readEntries(function(entries) {
					for (var i = 0, entry; entry = entries[i]; ++i) {
						if (entry.isDirectory) {
							entry.removeRecursively(function() {}, errorHandler);
						} else {
							entry.remove(function() {}, errorHandler);
						}
					}
					filelist.innerHTML = 'Directory emptied.';
				}, errorHandler);
			}, false);
		}

		// Initiate filesystem on page load.
		if (window.requestFileSystem) {
			initFS();
		}
	</script>
	-->
</head>
<body>
<header>
	<nav>
		<h1>Consize as Web App</h1>
		<ul>
			<li><label for="console">REPL</label></li>
			<li><label for="editor-input">Editor</label></li>
		</ul>
	</nav>
</header>
<aside>
	<h2>Files</h2>
	<label id="new-file" for="editor-name">New file</label>
	<ol id="files">
		<li>
			<h3>Consize</h3>
			<ol id="files-consize"></ol>
		</li>
	</ol>
</aside>
<article>
	<section id="repl">
		<h2>REPL</h2>
		<div id="console">
			<ul id="console-buffer"></ul>
			<div id="console-prompt">
				<span id="console-ns" class="ns">cljs.user=&gt;&nbsp;</span>
				<textarea id="console-input">(ns consize.web.core)</textarea>
			</div>
		</div>
	</section>
	<section id="editor">
		<h2>Editor</h2>
		<input id="editor-name" type="text"/>
		<input value="Save" id="editor-save" type="submit"/>
		<!--<input value="Delete" id="editor-delete" type="submit"/>-->
		<input value="Eval" id="editor-eval" type="submit"/>
		<textarea id="editor-input"></textarea>
	</section>
</article>
</body>
</html>
